 <!DOCTYPE html>
<html>
<head>
  <title>Create PDF</title>
  <style>
    body{
      background-color: rgb(47, 45, 45);
    }
    form{
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }
.a4-textarea {
    width: 595px;
    min-height: 740px;
    font-size: 16px;
    font-family:'Times New Roman', Times, serif;
    padding: 17px;
    box-sizing: border-box;
    border: 2px solid #ccc;
    background: #fff;
    box-shadow: 0 0 5px rgba(0,0,0,0.1);
    overflow-y: auto;

    /* PAGE BREAK MARKER for 740px */
    background-image:
      linear-gradient(to bottom,
        transparent 739px,         /* content area */
        rgba(0,0,0,0.3) 740px       /* page break line */
      );

    background-size: 100% 740px;   /* repeat every 740px */
    background-repeat: repeat-y;
}
  </style>
</head>
<body>

  <button class="btn"id="thicker" onclick=handleThicker()>BoldFoward</button>
  <button class="btn"id="underlin" onclick=handleUnderline()>UnderlineFoward</button>
  <button class="btn"id="itali" onclick=handleItalic()>ItalicFoward</button>
  <button class="btn"id="thick" onclick=handleThick()>Bold</button>
  <button class="btn" id="italy" onclick=handleItaly()>Italic</button>
  <button class="btn" id="under" onclick=handleUnder()>Underline</button>
  
  <select id="fontSizeSelect" onchange="handleFont()">
    <option value="8px">Small</option>
    <option value="20px">Medium</option>
    <option value="30px">Large</option>
    <option value="60px">Extra Large</option>
  </select>  
  <select id="fontColor" onchange="handleColor()">
    <option value="red">Red</option>
    <option value="green">Green</option>
    <option value="blue">Blue</option>
    <option value="yellow">Yellow</option>
  </select>  
  <select id="fontSize" onchange="handleFonting()">
    <option value="8px">8</option>
    <option value="20px">20</option>
    <option value="30px">30</option>
    <option value="60px">60</option>
  </select>  
  <select id="fontColour" onchange="handleColoring()">
    <option value="red">red</option>
    <option value="green">green</option>
    <option value="blue">blue</option>
    <option value="yellow">yellow</option>
  </select>

<form action="/file" method="POST">

  <div class="page">
    <div name="content" id="editor" class="a4-textarea" contenteditable="true" style="height: auto;" ></div>
    <textarea name="content" id="text" style="display:none"></textarea>
  </div>
  <br><br>
  <button type="submit">Generate PDF</button>
</form>

<script>
 document.getElementById("editor").addEventListener("paste", function(e) {
    e.preventDefault();

    const html = e.clipboardData.getData("text/html");
    const div = document.createElement("div");
    div.innerHTML = html;

    // remove inline styles
    div.querySelectorAll("*").forEach(el => el.removeAttribute("style"));

    document.execCommand("insertHTML", false, div.innerHTML);
});


function handleFont() {
  const size = document.getElementById("fontSizeSelect").value;

  const selection = window.getSelection();
  if (!selection.rangeCount) return;

  const range = selection.getRangeAt(0);

  const span = document.createElement("span");
  span.style.fontSize = size;

  range.surroundContents(span);
}
function handleColor() {
  const col = document.getElementById("fontColor").value;

  const selection = window.getSelection();
  if (!selection.rangeCount) return;

  const range = selection.getRangeAt(0);

  const span = document.createElement("span");
  span.style.color = col;

  range.surroundContents(span);
}

document.querySelector('form').addEventListener('submit',(e)=>{
  const html= document.querySelector('#editor').innerHTML;
  document.querySelector('#text').value=html;
})

function handleThick(){
  const selection = window.getSelection();
  if (!selection.rangeCount) return;

  const range = selection.getRangeAt(0);

  const span = document.createElement("span");
  span.style.fontWeight="bold";

  range.surroundContents(span);
}

function handleItaly(){
   const selection = window.getSelection();
  if (!selection.rangeCount) return;

  const range = selection.getRangeAt(0);

  const span = document.createElement("span");
  span.style.fontStyle="Italic";

  range.surroundContents(span);
}

function handleUnder(){
   const selection = window.getSelection();
  if (!selection.rangeCount) return;

  const range = selection.getRangeAt(0);

  const span = document.createElement("span");
  span.style.textDecoration="underline";

  range.surroundContents(span);
}

function placeCursorInside(el) {
const range = document.createRange();
const sel = window.getSelection();
range.selectNodeContents(el);
range.collapse(true);
sel.removeAllRanges();
sel.addRange(range);
}

let isBoldActive=false;
let prevBold=null;

function handleThicker(){
  isBoldActive=true;
  const selection = window.getSelection();
  const range=selection.getRangeAt(0);
    const div=document.createElement('div')
    div.contentEditable="true";
    div.style.display="inline-block";
    div.style.minWidth="50px";
    // div.style.border="1px solid #aaa";
    div.style.padding="0.5px";
    div.className="boldy"
    div.style.fontWeight="bold";
    range.insertNode(div)
    prevBold=div;
      range.surroundContents(div);
    placeCursorInside(div);
    console.log("bold ho gya");
  }

  let isFontChange=false;
  let prevFont=null;

function handleFonting(){
  isFontChange=true;
  const len=document.querySelector('#fontSize').value
  const selection = window.getSelection();
  const range=selection.getRangeAt(0);
    const div=document.createElement('div')
    div.contentEditable="true";
    div.style.display="inline-block";
    div.style.minWidth="50px";
    // div.style.border="1px solid #aaa";
    div.style.padding="5px";
    div.className="fonty"
    div.style.fontSize=len;
    range.insertNode(div)
    prevFont=div;
      range.surroundContents(div);
    placeCursorInside(div);
    console.log("fontChange ho gya");
  }
  let isColorChange=false;
  let prevColor=null;

function handleColoring(){
  isColorChange=true;
  const col=document.querySelector('#fontColour').value
  const selection = window.getSelection();
  const range=selection.getRangeAt(0);
    const div=document.createElement('div')
    div.contentEditable="true";
    div.style.display="inline-block";
    div.style.minWidth="50px";
    // div.style.border="1px solid #aaa";
    div.style.padding="5px";
    div.className="fonty"
    div.style.color=col;
    range.insertNode(div)
    prevColor=div;
      range.surroundContents(div);
    placeCursorInside(div);
    console.log("colorChange ho gya");
  }
  
  
  let isUnderlineActive=false;
  let prevUnder=null;
function handleUnderline(){
   const selection = window.getSelection();
   const range=selection.getRangeAt(0);
    const div=document.createElement('div')
    div.contentEditable="true";
    div.style.display="inline-block";
    div.style.minWidth="50px";
    // div.style.border="1px solid #aaa";
    div.style.padding="5px";
    // div.className="under"
    div.style.textDecoration="underline";
    range.insertNode(div)
    prevUnder=div;
      range.surroundContents(div);
    placeCursorInside(div);
    console.log("underline ho gya");
    
}
let isItalicActive=false;
function handleItalic(){
   const selection = window.getSelection();
   const range=selection.getRangeAt(0);
   const div=document.createElement('div')
    div.contentEditable="true";
    div.style.display="inline-block";
    div.style.minWidth="50px";
    // div.style.border="1px solid #aaa";
    div.style.padding="5px";
    // div.className="italy"
    div.style.fontStyle="Italic";
    range.insertNode(div)
    prevItalic=div;
      range.surroundContents(div);
    placeCursorInside(div);
    console.log("Italic ho gya");
  }
  
const edit=document.querySelector('#editor')
edit.addEventListener('keydown',(e)=>{
  if(e.key=="Enter"){
    if(isBoldActive && prevBold){
        e.preventDefault();
        isBoldActive=false;
        prevBold=null;
    } 
     if(isItalicActive && prevItalic){
       e.preventDefault();
       isItalicActive=false;
       prevItalic=null;

     } 
     if (isUnderlineActive && prevUnder ){
       e.preventDefault();
       isUnderlineActive=false;
       prevUnder=null;

     } 
     if(isFontChange && prevFont){
    e.preventDefault();
    isFontChange=false;
    prevFont=null;
    }
     if(isColorChange && prevColor){
    e.preventDefault();
    isColorChange=false;
    prevColor=null;
    }
    const normal=document.createElement('div')
    normal.innerHTML="<br>"
    edit.appendChild(normal)
    placeCursorInside(normal);
    console.log("Exited bold mode â€” normal text now");
  }
})

</script>

</body>
</html>



