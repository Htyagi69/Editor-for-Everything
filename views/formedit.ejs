<!DOCTYPE html>
<html>
<head>
  <title>Create PDF</title>
  <style>
    form{
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }
.a4-textarea {
    width: 595px;
    min-height: 740px;
    font-size: 16px;
    font-family:'Times New Roman', Times, serif;
    padding: 12px;
    box-sizing: border-box;
    border: 2px solid #ccc;
    background: #fff;
    box-shadow: 0 0 5px rgba(0,0,0,0.1);
    overflow-y: auto;

    /* PAGE BREAK MARKER for 740px */
    background-image:
      linear-gradient(to bottom,
        transparent 739px,         /* content area */
        rgba(0,0,0,0.3) 740px       /* page break line */
      );

    background-size: 100% 740px;   /* repeat every 740px */
    background-repeat: repeat-y;
}
  </style>
</head>
<body>

  <button class="btn"id="thick" onclick=handleThick()>Bold</button>
  <button class="btn" id="italy" onclick=handleItaly()>Italic</button>
  <button class="btn" id="under" onclick=handleUnder()>Underline</button>

<form action="/file" method="POST">
  <select id="fontSizeSelect" onchange="handleFont()">
    <option value="8px">Small</option>
    <option value="20px">Medium</option>
    <option value="30px">Large</option>
    <option value="60px">Extra Large</option>
  </select>  


  <div class="page">
    <div name="content" id="editor" class="a4-textarea" contenteditable="true" style="height: auto;" ></div>
    <textarea name="content" id="text" style="display:none"></textarea>
  </div>

  <br><br>
  <button type="submit">Generate PDF</button>
</form>

<script>
 document.getElementById("editor").addEventListener("paste", function(e) {
    e.preventDefault();

    const html = e.clipboardData.getData("text/html");
    const div = document.createElement("div");
    div.innerHTML = html;

    // remove inline styles
    div.querySelectorAll("*").forEach(el => el.removeAttribute("style"));

    document.execCommand("insertHTML", false, div.innerHTML);
});


function handleFont() {
  const size = document.getElementById("fontSizeSelect").value;

  const selection = window.getSelection();
  if (!selection.rangeCount) return;

  const range = selection.getRangeAt(0);

  const span = document.createElement("span");
  span.style.fontSize = size;

  range.surroundContents(span);
}

document.querySelector('form').addEventListener('submit',(e)=>{
  const html= document.querySelector('#editor').innerHTML;
  document.querySelector('#text').value=html;
})

function handleThick(){
  const selection = window.getSelection();
  if (!selection.rangeCount) return;

  const range = selection.getRangeAt(0);

  const span = document.createElement("span");
  span.style.fontWeight="bold";

  range.surroundContents(span);
}

function handleItaly(){
   const selection = window.getSelection();
  if (!selection.rangeCount) return;

  const range = selection.getRangeAt(0);

  const span = document.createElement("span");
  span.style.fontStyle="Italic";

  range.surroundContents(span);
}

function handleUnder(){
   const selection = window.getSelection();
  if (!selection.rangeCount) return;

  const range = selection.getRangeAt(0);

  const span = document.createElement("span");
  span.style.textDecoration="underline";

  range.surroundContents(span);
}
</script>

</body>
</html>
